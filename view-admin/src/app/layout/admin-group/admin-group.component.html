<nz-collapseset [nzBordered]="false" class="collapse-head">
  <nz-collapse [nzTitle]="'新增管理组'" nzActive="false">
    <form nz-form [nzType]="'horizontal'" [formGroup]="addItemForm">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="1">
          <label>名称</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="6">
          <nz-input formControlName="groupName" nzPlaceHolder="管理组名称" spellcheck="false" [nzSize]="'large'"></nz-input>
          <div nz-form-explain *ngIf="addItemForm.controls.groupName.dirty&&addItemForm.controls.groupName.hasError('required')">请输入管理组名称</div>
        </div>
      </div>
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="1">
          <label>权限</label>
        </div>
        <div nz-col [nzSpan]="16">
          <nz-transfer [nzDataSource]="authList" [nzTitles]="['权限列表', '拥有权限']" [nzListStyle]="{'width.px': 300, 'height.px': 300}" (nzSelectChange)="selectAuth($event)" (nzChange)="addSelectChange($event)" [nzNotFoundContent]="'未选择权限'">
            <ng-template #render let-item>
              {{item.category}} - {{item.name}}
            </ng-template>
          </nz-transfer>
        </div>
      </div>
      <div nz-form-item nz-row>
        <div nz-form-control nz-col [nzSpan]="6">
          <button nz-button [nzType]="'primary'" [nzSize]="'large'" [disabled]="!addItemForm.valid" (click)="addAdminGroup()" [nzLoading]="_addItemLoading">提交</button>
        </div>
      </div>
    </form>
  </nz-collapse>
</nz-collapseset>
<nz-table #nzTable [nzAjaxData]="_dataSet" nzShowTotal [nzShowSizeChanger]="true" [nzShowQuickJumper]="true" [nzLoading]="_loading"
  [nzTotal]="_total" [(nzPageSize)]="_pageSize" [(nzPageIndex)]="_current" (nzPageIndexChange)="refreshData()" [nzPageSize]="_pageSize"
  (nzPageSizeChange)="_pageSizeChange($event)">
  <thead nz-thead>
    <tr>
      <th nz-th [nzCheckbox]="true">
        <label nz-checkbox [(ngModel)]="_allChecked" [nzIndeterminate]="_indeterminate" (ngModelChange)="_checkAll($event)">
        </label>
      </th>
      <th nz-th nzWidth="5%">
        <span>序号</span>
      </th>
      <th nz-th nzWidth="10%">
        <span>名称</span>
      </th>
      <th nz-th nzWidth="60%">
        <span>权限</span>
      </th>
      <th nz-th>
        <span>操作</span>
      </th>
    </tr>
  </thead>
  <tbody nz-tbody>
    <tr nz-tbody-tr *ngFor="let data of nzTable.data;let i=index">
      <td nz-td [nzCheckbox]="true">
        <label nz-checkbox [(ngModel)]="data.checked" (ngModelChange)="_refreshStatus($event)">
        </label>
      </td>
      <td nz-td>{{i+1}}</td>
      <td nz-td>{{data.name}}</td>
      <td nz-td>
        <span *ngFor="let auth of data._auth">{{auth.category}}-<b>{{auth.name}}</b>&nbsp;&nbsp;&nbsp;</span>
      </td>
      <td nz-td>
        <button nz-button [nzType]="'primary'" (click)="_showEditModal(data)">
          <i class="anticon anticon-edit"></i>
          <span>修改</span>
        </button>
        <button nz-button [nzType]="'danger'" (click)="removeItemModal(data.id, data.name)">
          <i class="anticon anticon-delete"></i>
          <span>删除</span>
        </button>
      </td>
    </tr>
  </tbody>
</nz-table>
<!-- 修改管理组的modal -->
<nz-modal [nzVisible]="_isVisibleEdit" [nzTitle]="modalTitle" [nzContent]="modalContent" [nzFooter]="modalFooter" (nzOnCancel)="_editHandleCancel($event)" [nzWidth]="'800px'">
  <ng-template #modalTitle>修改管理组</ng-template>
  <ng-template #modalContent>
    <form nz-form [nzType]="'horizontal'" [formGroup]="editItemForm">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="2">
          <label>名称</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="16">
          <nz-input formControlName="groupName" nzPlaceHolder="管理组名称" spellcheck="false" [nzSize]="'large'"></nz-input>
          <div nz-form-explain *ngIf="editItemForm.controls.groupName.dirty&&editItemForm.controls.groupName.hasError('required')">请输入管理组名称</div>
        </div>
      </div>
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="2">
          <label>权限</label>
        </div>
        <div nz-col [nzSpan]="22">
          <nz-transfer [nzDataSource]="editAuthList" [nzTitles]="['权限列表', '拥有权限']" [nzListStyle]="{'width.px': 300, 'height.px': 300}" (nzSelectChange)="selectAuth($event)" (nzChange)="editSelectChange($event)" [nzNotFoundContent]="'未选择权限'">
            <ng-template #render let-item>
              {{item.category}} - {{item.name}}
            </ng-template>
          </nz-transfer>
        </div>
      </div>
    </form>
  </ng-template>
  <ng-template #modalFooter>
    <button nz-button [nzType]="'default'" [nzSize]="'large'" (click)="_editHandleCancel($event)">取消</button>
    <button nz-button [nzType]="'primary'" [nzSize]="'large'" (click)="_editHandleOk($event)" [nzLoading]="_isEditConfirmLoading" [disabled]="!editItemForm.valid">提交</button>
  </ng-template>
</nz-modal>